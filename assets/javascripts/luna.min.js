(function(b,a){a.Luna={removePerson:function(c){b(c).parent().remove();return false},addBeneficiary:function(d,c){var f=b("<div>").html(c).text();var j=b("ul#luna-beneficiaries");if(j.children("li."+d).length==0){var e=b("<li>").addClass(d).html(f);var k=b("<select>").attr("name","users["+d+"]");var l=j.data("levels");for(var g=0;g<l.length;g++){var h=b("<option>").attr("value",l[g].value).html(l[g].name);k.append(h)}e.append(k);j.append(e)}},getFilterNames:function(){var d=b("#luna-newfilter");var c=b("#luna-newfilter-name");var e=b("#luna-newfilter-config");b.ajax({url:d.data("filternames-url"),dataType:"json",beforeSend:function(g,f){d.removeClass("hidden-js");c.html(b("<img>").attr("width",16).attr("height",16).attr("src",a.ASSETS_URL+"images/ajax-indicator-black.svg"))},success:function(g){d.addClass("newfilter");var f=b("<select>").attr("name","field").on("change",function(){b.ajax({url:b("#luna-newfilter").data("filterdata-url"),data:{field:b('select[name="field"] option:selected').val()},dataType:"json",beforeSend:function(j,i){e.html(b("<img>").attr("width",16).attr("height",16).attr("src",a.ASSETS_URL+"images/ajax-indicator-black.svg"))},success:function(l){var m=l.compare;var k=b("<select>").attr("name","compare");b.each(m,function(n,o){var p=b("<option>").attr("value",n).html(o);k.append(p)});var j=l.values;var i=b("<select>").attr("name","value");b.each(j,function(n,p){var o=b("<option>").attr("value",n).html(p);i.append(o)});e.html("");e.append(k);e.append(i);b('button[name="apply"]').removeClass("hidden-js")}})});var h=b("<option>").attr("value","").html("-- "+d.data("pleasechoose")+" --");f.append(h);b.each(g,function(i,k){var j=b("<option>").attr("value",i).html(k);f.append(j)});c.html(f)}})},removeFilter:function(d){b(d).parent().remove();var c=b("#luna-applied-filters");c.data("filter-count",c.data("filter-count")-1);if(c.children("span.luna-filter").length==0){c.addClass("hidden-js")}a.Luna.loadPersons()},loadPersons:function(){var c=b("#luna-data");b.ajax({url:c.data("update-url"),data:b('input[type="hidden"][name*="filters["]').serialize(),dataType:"html",beforeSend:function(e,d){c.html(b("<img>").attr("width",64).attr("height",64).attr("src",a.ASSETS_URL+"images/ajax-indicator-black.svg"))},success:function(d){c.html(d)}})}};b(document).ready(function(){b("#luna-add-filter").on("click",function(){a.Luna.getFilterNames();return false});b(".luna-remove-filter").on("click",function(){a.Luna.removeFilter(this);return false});a.Luna.loadPersons()})}(jQuery,STUDIP));